package br.com.lunacore.lunalire;

import java.util.HashMap;

import com.badlogic.gdx.Gdx;
import com.badlogic.gdx.graphics.g2d.SpriteBatch;
import com.badlogic.gdx.utils.XmlReader;
import com.badlogic.gdx.utils.XmlReader.Element;

public class LireStateManager {
	
	HashMap<Integer, LireScene> scenes;	
	int currentScene = -1;
	
	public LireStateManager() {
		scenes = new HashMap<Integer, LireScene>();
		XmlReader reader = new XmlReader();
		Element root = reader.parse(Gdx.files.internal("project.ll"));
		
		//Carrega as cenas a partir do arquivo .ll
		
		for(Element sc : root.getChildrenByName("scene")) {
			LireScene lr = new LireScene(sc);
			//Pegar alguma configuração de startScene
			//por enquanto ele carrega na primeira
			
			String loc = sc.getAttribute("loc");
			System.out.println("Loading scene " + loc);
			
			Element ss = reader.parse(Gdx.files.internal(loc));
			
			int ID = Integer.parseInt(ss.getAttribute("ID"));
			scenes.put(ID, lr);
			if(currentScene == -1) {
				currentScene = ID;
			}
		}
	}
	
	public void render(SpriteBatch sb) {
		if(currentScene != -1) {
			scenes.get(currentScene).render(sb);
		}
	}

	public void update(float delta) {
		if(currentScene != -1) {
			scenes.get(currentScene).update(delta);
		}
	}

	public void dispose() {
		
	}

}
